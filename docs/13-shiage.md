# 仕上げ

## 光が暗くなるのを直す
シーンが切り替わるとゲームが暗くなってしまう。これは、環境光の設定の問題で、Unityでよく発生する問題です。

- 参考： https://youtu.be/mEjT_7qZnHs

シーンを照らす光は、物体に直接当たっている光だけではありません。環境光(Environment Lighting)という大気が乱反射する光(Ambient)や、他の物体が跳ね返した光(Reflection)といった光からも照らされます。これらをグローバルイルミネーション(GI)と呼び、CGにリアリティを持たせるのに大切な要素です。

環境光は周りの状況によって様々な反射をするため、まじめに計算すると大変な計算量になります。そこで、リアルタイムCGの世界では、予め計算をしておいてデータ化しておくことをします。

この計算には時間がかかるため、ライトが決まっていない時は、簡易な計算をGIのキャッシュに一時的に計算して実行して、シーンが切り替わったらその結果を破棄してしまいます。そのため、シーンが切り替わった後に再度ゲームを実行すると、環境光のデータが消えてしまっているので暗くなってしまうのです。

エディターで作業している時に、この症状を避けるには、ライトが決まったところで、GIのデータを手動で生成することをします。

- [Window]メニューから[Lighting]を選択
- ウィンドウ下の[Auto]のチェックを外す
- [Build]ボタンが押せるようになるのでクリック
- 作業が終わるまで待つ

以上で、環境光のデータが生成されるので、シーンが切り替わっても暗くならなくなります。

<b>ビルドすると、[Auto]に戻すか、再度ビルドしない限り、光や周囲の状況を変化させても、環境光が変化を受けなくなりますので、ビルド後にライティングなどを変更した場合は、ビルドのし直しが必要になるので気をつけてください。</b>

因みに、これはUnityエディター上で起きる開発時の挙動です。ビルドした実行ファイルは、ちゃんと環境光データをビルドしますので問題は起きません。ビルドしない状態で展示をしたり、開発時に必要な場合にこのような対処を覚えておいてください。

## ゲームオーバー・クリア時に動きととめる
- 案1)ゲーム時間を止める
- 案2)Rigidbodyを全て検索して無効にする
- 案3)Rigidbodyを持っているゲームオブジェクトを全てモック化する

案2,3はいずれも処理の負荷が重いので、できればやりたくない。そこで、案1の物理時間を停止する方法を試す。

ゲームの進行時間は、`Time.timeScale`プロパティーで設定できる。1だとリアルタイムに動き、2にすると時間の流れが2倍になり、0.5にすれば時間の流れは1/2になる。スローモーションにしたり、早まわしの演出に使われる。

このパラメーターに0を設定すれば、時間が流れなくなるので、全てのオブジェクトを停止させることができる。

- `GameManager.cs`を開く
- シーンの切り替え時に`Time.timeScale = 0;`を実行

このままだと、次にゲームを開始した時に時間が流れなくなってしまうので、ゲームの開始時に`Time.timeScale = 1;`を追加する

## 出現の仕方をコントロールする
現在は画面内の範囲で乱数にアイテムや敵を出現させているが、これだとステージなど、面データを作ることができない。出現タイミングや、出現場所を自在に設定するテクニックとして、スポーナーオブジェクト(SpawnerObject)を作ることがよく行われる。敵を直接生成するのではなく、
敵を生成するオブジェクトを作って、それ












